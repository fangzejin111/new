<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç…§ç‰‡å¢™ | åœŸé¸¡è›‹</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ’–</text></svg>">
    <style>
        /* ç…§ç‰‡å¢™é¡µé¢ç‰¹æœ‰æ ·å¼ */
        .photos-hero {
            background: linear-gradient(135deg, rgba(78, 205, 196, 0.1), rgba(255, 142, 83, 0.1));
            padding: 100px 0 60px;
            margin-top: 70px;
            text-align: center;
            border-radius: 0 0 var(--border-radius-lg) var(--border-radius-lg);
        }
        
        .photos-hero h1 {
            font-size: 3rem;
            margin-bottom: 1rem;
            color: var(--text-color);
        }
        
        .upload-section {
            max-width: 800px;
            margin: 40px auto;
            text-align: center;
        }
        
        .upload-box {
            background: var(--card-bg);
            border: 3px dashed var(--primary-light);
            border-radius: var(--border-radius-lg);
            padding: 40px;
            cursor: pointer;
            transition: all var(--transition-normal);
        }
        
        .upload-box:hover {
            border-color: var(--primary-color);
            transform: translateY(-5px);
            box-shadow: var(--shadow-medium);
        }
        
        .upload-box i {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .upload-box p {
            color: var(--text-light);
            margin-bottom: 20px;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: var(--border-radius-md);
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: inline-block;
            transition: all var(--transition-fast);
        }
        
        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .photos-container {
            max-width: 1200px;
            margin: 40px auto;
            padding: 0 20px;
        }
        
        .photos-filter {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .filter-btn {
            background: var(--card-bg);
            color: var(--text-color);
            border: 2px solid var(--primary-light);
            padding: 10px 20px;
            border-radius: var(--border-radius-md);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all var(--transition-fast);
        }
        
        .filter-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }
        
        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .photos-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .photo-card {
            background: var(--card-bg);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-medium);
            transition: all var(--transition-normal);
            cursor: pointer;
        }
        
        .photo-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-heavy);
        }
        
        .photo-img {
            width: 100%;
            height: 200px;
            object-fit: cover;
            background: linear-gradient(135deg, var(--primary-light), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
        }
        
        .photo-info {
            padding: 20px;
        }
        
        .photo-title {
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--text-color);
        }
        
        .photo-date {
            color: var(--text-light);
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .photo-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .action-btn {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: var(--border-radius-sm);
            font-size: 0.9rem;
            cursor: pointer;
            transition: all var(--transition-fast);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .like-btn {
            background: #ffebee;
            color: #e74c3c;
        }
        
        .like-btn:hover {
            background: #ffcdd2;
        }
        
        .like-btn.liked {
            background: #e74c3c;
            color: white;
        }
        
        .share-btn {
            background: #e8f4fc;
            color: #3498db;
        }
        
        .share-btn:hover {
            background: #d6eaf8;
        }
        
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .lightbox.active {
            display: flex;
        }
        
        .lightbox-content {
            max-width: 90%;
            max-height: 90%;
        }
        
        .lightbox-img {
            max-width: 100%;
            max-height: 100%;
            border-radius: var(--border-radius-md);
        }
        
        .lightbox-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            background: none;
            border: none;
        }
        
        .lightbox-nav {
            position: absolute;
            top: 50%;
            width: 100%;
            display: flex;
            justify-content: space-between;
            padding: 0 20px;
            transform: translateY(-50%);
        }
        
        .lightbox-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all var(--transition-fast);
        }
        
        .lightbox-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }
        
        .no-photos {
            text-align: center;
            padding: 60px;
            color: var(--text-light);
            font-size: 1.2rem;
            grid-column: 1 / -1;
        }
        
        @media (max-width: 768px) {
            .photos-hero h1 {
                font-size: 2.2rem;
            }
            
            .photos-grid {
                grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            }
        }
        
        @media (max-width: 480px) {
            .photos-grid {
                grid-template-columns: 1fr;
            }
            
            .photos-filter {
                flex-direction: column;
                align-items: center;
            }
            
            .filter-btn {
                width: 200px;
            }
        }
    </style>
</head>
<body>
    <!-- å¯¼èˆªæ  -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-logo">
                <i class="fas fa-heart"></i> å…ƒæ—¦å¿«ä¹
            </a>
            <ul class="nav-menu">
                <li><a href="index.html"><i class="fas fa-home"></i> ä¸»é¡µ</a></li>
                <li><a href="moments.html"><i class="fas fa-heart"></i> ç‰¹åˆ«å›å¿†</a></li>
                <li><a href="photos.html"><i class="fas fa-images"></i> ç…§ç‰‡å¢™</a></li>
                <li><a href="countdown.html"><i class="fas fa-calendar-alt"></i> é‡è¦æ—¥å­</a></li>
                <li><a href="surprise.html"><i class="fas fa-gift"></i> å°æƒŠå–œ</a></li>
            </ul>
            <div class="hamburger">
                <i class="fas fa-bars"></i>
            </div>
        </div>
    </nav>

    <!-- æµ®åŠ¨çˆ±å¿ƒèƒŒæ™¯ -->
    <div class="floating-hearts" id="hearts-container"></div>

    <!-- ä¸»å†…å®¹ -->
    <div class="container">
        <!-- è‹±é›„åŒºåŸŸ -->
        <section class="photos-hero">
            <h1><i class="fas fa-images"></i> æˆ‘ä»¬çš„ç…§ç‰‡å¢™</h1>
            <p class="hero-subtitle">çè—æ¯ä¸€ä¸ªç¾å¥½ç¬é—´</p>
        </section>

        <!-- ä¸Šä¼ åŒºåŸŸ -->
        <div class="upload-section">
            <div class="upload-box" onclick="document.getElementById('fileInput').click()">
                <i class="fas fa-cloud-upload-alt"></i>
                <p>ç‚¹å‡»è¿™é‡Œä¸Šä¼ ç…§ç‰‡ï¼ˆæ¨¡æ‹ŸåŠŸèƒ½ï¼‰</p>
                <p style="font-size: 0.9rem; color: var(--text-lighter);">
                    æ”¯æŒ JPGã€PNG æ ¼å¼ï¼Œæœ€å¤§ 5MB
                </p>
                <div class="upload-btn">é€‰æ‹©ç…§ç‰‡</div>
            </div>
            <input type="file" id="fileInput" accept="image/*" multiple hidden onchange="handleFileUpload(event)">
        </div>

        <!-- ç…§ç‰‡ç­›é€‰ -->
        <div class="photos-container">
            <div class="photos-filter">
                <button class="filter-btn active" data-filter="all">å…¨éƒ¨ç…§ç‰‡</button>
                <button class="filter-btn" data-filter="favorite">æœ€å–œçˆ±</button>
                <button class="filter-btn" data-filter="recent">æœ€è¿‘æ·»åŠ </button>
                <button class="filter-btn" data-filter="oldest">æœ€æ—©æ·»åŠ </button>
            </div>

            <!-- ç…§ç‰‡ç½‘æ ¼ -->
            <div class="photos-grid" id="photosGrid">
                <!-- ç…§ç‰‡ä¼šé€šè¿‡JavaScriptåŠ¨æ€åŠ è½½ -->
                <div class="no-photos">
                    <i class="fas fa-camera" style="font-size: 3rem; margin-bottom: 20px;"></i>
                    <p>è¿˜æ²¡æœ‰ç…§ç‰‡ï¼Œç‚¹å‡»ä¸Šæ–¹ä¸Šä¼ åŒºåŸŸæ·»åŠ ç…§ç‰‡å§ï¼</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ç¯ç®±ï¼ˆæŸ¥çœ‹å¤§å›¾ï¼‰ -->
    <div class="lightbox" id="lightbox">
        <button class="lightbox-close" onclick="closeLightbox()">
            <i class="fas fa-times"></i>
        </button>
        <div class="lightbox-nav">
            <button class="lightbox-btn" onclick="prevPhoto()">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="lightbox-btn" onclick="nextPhoto()">
                <i class="fas fa-chevron-right"></i>
            </button>
        </div>
        <div class="lightbox-content">
            <img class="lightbox-img" id="lightboxImg" src="" alt="">
            <div id="lightboxInfo" style="color: white; text-align: center; margin-top: 20px;"></div>
        </div>
    </div>

    <!-- é¡µè„š -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h3><i class="fas fa-images"></i> å…³äºç…§ç‰‡å¢™</h3>
                <p>è¿™æ˜¯ä¸€ä¸ªè™šæ‹Ÿçš„ç…§ç‰‡å¢™ï¼Œä¸Šä¼ çš„ç…§ç‰‡ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°ã€‚</p>
                <p>è®°å¾—å®šæœŸå¤‡ä»½é‡è¦ç…§ç‰‡å“¦ï¼</p>
            </div>
            <div class="footer-section">
                <h3><i class="fas fa-link"></i> å¿«é€Ÿé“¾æ¥</h3>
                <div class="footer-links">
                    <a href="index.html"><i class="fas fa-home"></i> ä¸»é¡µ</a>
                    <a href="moments.html"><i class="fas fa-heart"></i> å›å¿†</a>
                    <a href="countdown.html"><i class="fas fa-calendar"></i> å€’è®¡æ—¶</a>
                </div>
            </div>
            <div class="footer-section">
                <h3><i class="fas fa-info-circle"></i> ç…§ç‰‡ç®¡ç†</h3>
                <p>ç…§ç‰‡ä¿å­˜åœ¨æµè§ˆå™¨æœ¬åœ°å­˜å‚¨ä¸­ã€‚</p>
                <p>æ›´æ¢è®¾å¤‡æˆ–æ¸…é™¤ç¼“å­˜ä¼šå¯¼è‡´ç…§ç‰‡ä¸¢å¤±ã€‚</p>
            </div>
        </div>
        <div class="footer-bottom">
            <p>Â© 2024 å…ƒæ—¦ç‰¹åˆ«ç‰ˆ | ä¸“ä¸º <span class="highlight-name">åœŸé¸¡è›‹</span> åˆ¶ä½œ</p>
            <p class="footer-note">
                <i class="fas fa-heart"></i> ç”¨ç…§ç‰‡è®°å½•ç¾å¥½æ—¶å…‰ <i class="fas fa-heart"></i>
            </p>
        </div>
    </footer>

    <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
    <button class="back-to-top" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- åŠ è½½è„šæœ¬ -->
    <script src="js/main.js"></script>
    <script>
        // ç…§ç‰‡å¢™é¡µé¢ç‰¹æœ‰åŠŸèƒ½
        let currentPhotos = [];
        let currentFilter = 'all';
        let currentLightboxIndex = 0;
        
        document.addEventListener('DOMContentLoaded', function() {
            // åŠ è½½å·²æœ‰ç…§ç‰‡
            loadPhotos();
            
            // åˆå§‹åŒ–ç­›é€‰æŒ‰é’®
            initFilterButtons();
            
            // åˆå§‹åŒ–è¿”å›é¡¶éƒ¨æŒ‰é’®
            initBackToTop();
            
            // åˆå§‹åŒ–æµ®åŠ¨çˆ±å¿ƒ
            initFloatingHearts();
        });
        
        // åŠ è½½ç…§ç‰‡
        function loadPhotos() {
            currentPhotos = JSON.parse(localStorage.getItem('photos')) || [];
            filterPhotos(currentFilter);
        }
        
        // åˆå§‹åŒ–ç­›é€‰æŒ‰é’®
        function initFilterButtons() {
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    // æ›´æ–°æŒ‰é’®çŠ¶æ€
                    document.querySelectorAll('.filter-btn').forEach(b => {
                        b.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    // ç­›é€‰ç…§ç‰‡
                    currentFilter = this.getAttribute('data-filter');
                    filterPhotos(currentFilter);
                });
            });
        }
        
        // ç­›é€‰ç…§ç‰‡
        function filterPhotos(filter) {
            let filteredPhotos = [...currentPhotos];
            
            switch(filter) {
                case 'favorite':
                    filteredPhotos = filteredPhotos.filter(photo => photo.liked);
                    break;
                case 'recent':
                    filteredPhotos.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
                case 'oldest':
                    filteredPhotos.sort((a, b) => new Date(a.date) - new Date(b.date));
                    break;
                case 'all':
                default:
                    filteredPhotos.sort((a, b) => new Date(b.date) - new Date(a.date));
                    break;
            }
            
            renderPhotos(filteredPhotos);
        }
        
        // æ¸²æŸ“ç…§ç‰‡
        function renderPhotos(photos) {
            const photosGrid = document.getElementById('photosGrid');
            
            if (photos.length === 0) {
                photosGrid.innerHTML = `
                    <div class="no-photos">
                        <i class="fas fa-camera" style="font-size: 3rem; margin-bottom: 20px;"></i>
                        <p>è¿˜æ²¡æœ‰ç…§ç‰‡ï¼Œç‚¹å‡»ä¸Šæ–¹ä¸Šä¼ åŒºåŸŸæ·»åŠ ç…§ç‰‡å§ï¼</p>
                    </div>
                `;
                return;
            }
            
            photosGrid.innerHTML = '';
            
            photos.forEach((photo, index) => {
                const photoCard = document.createElement('div');
                photoCard.className = 'photo-card';
                photoCard.setAttribute('data-index', index);
                
                // ç”ŸæˆéšæœºèƒŒæ™¯è‰²
                const colors = [
                    'linear-gradient(135deg, #FF6B8B, #FF8E53)',
                    'linear-gradient(135deg, #4ECDC4, #44A08D)',
                    'linear-gradient(135deg, #9C88FF, #8C7AE6)',
                    'linear-gradient(135deg, #3498DB, #2980B9)',
                    'linear-gradient(135deg, #2ECC71, #27AE60)'
                ];
                const bgColor = colors[index % colors.length];
                
                photoCard.innerHTML = `
                    <div class="photo-img" style="background: ${bgColor};">
                        ${photo.dataUrl ? 
                            `<img src="${photo.dataUrl}" alt="${photo.title}" style="width: 100%; height: 100%; object-fit: cover;">` : 
                            `<i class="fas fa-image"></i>`
                        }
                    </div>
                    <div class="photo-info">
                        <div class="photo-title">${photo.title || 'æœªå‘½åç…§ç‰‡'}</div>
                        <div class="photo-date">
                            <i class="far fa-calendar"></i> ${photo.date}
                        </div>
                        <div class="photo-actions">
                            <button class="action-btn like-btn ${photo.liked ? 'liked' : ''}" 
                                    onclick="toggleLike(${index})">
                                <i class="fas fa-heart"></i>
                                <span>${photo.likes || 0}</span>
                            </button>
                            <button class="action-btn share-btn" onclick="sharePhoto(${index})">
                                <i class="fas fa-share-alt"></i>
                                <span>åˆ†äº«</span>
                            </button>
                        </div>
                    </div>
                `;
                
                // ç‚¹å‡»æŸ¥çœ‹å¤§å›¾
                photoCard.addEventListener('click', (e) => {
                    if (!e.target.closest('.photo-actions')) {
                        openLightbox(index);
                    }
                });
                
                photosGrid.appendChild(photoCard);
            });
        }
        
        // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
        function handleFileUpload(event) {
            const files = event.target.files;
            
            if (!files || files.length === 0) return;
            
            Array.from(files).forEach((file, index) => {
                if (!file.type.match('image.*')) {
                    showNotification('åªèƒ½ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼');
                    return;
                }
                
                if (file.size > 5 * 1024 * 1024) { // 5MBé™åˆ¶
                    showNotification('æ–‡ä»¶å¤§å°ä¸èƒ½è¶…è¿‡5MBï¼');
                    return;
                }
                
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const photo = {
                        id: Date.now() + index,
                        title: file.name.replace(/\.[^/.]+$/, ""), // å»æ‰æ‰©å±•å
                        date: new Date().toISOString().split('T')[0],
                        dataUrl: e.target.result,
                        likes: 0,
                        liked: false
                    };
                    
                    // æ·»åŠ åˆ°ç…§ç‰‡åˆ—è¡¨
                    currentPhotos.unshift(photo);
                    localStorage.setItem('photos', JSON.stringify(currentPhotos));
                    
                    // é‡æ–°åŠ è½½ç…§ç‰‡
                    filterPhotos(currentFilter);
                    
                    // æ˜¾ç¤ºé€šçŸ¥
                    showNotification(`"${photo.title}" ä¸Šä¼ æˆåŠŸï¼`);
                };
                
                reader.readAsDataURL(file);
            });
            
            // é‡ç½®æ–‡ä»¶è¾“å…¥
            event.target.value = '';
        }
        
        // åˆ‡æ¢å–œæ¬¢çŠ¶æ€
        function toggleLike(index) {
            const photos = JSON.parse(localStorage.getItem('photos')) || [];
            
            if (index >= 0 && index < photos.length) {
                photos[index].liked = !photos[index].liked;
                photos[index].likes = photos[index].liked ? 
                    (photos[index].likes || 0) + 1 : 
                    Math.max(0, (photos[index].likes || 1) - 1);
                
                localStorage.setItem('photos', JSON.stringify(photos));
                loadPhotos();
            }
        }
        
        // åˆ†äº«ç…§ç‰‡
        function sharePhoto(index) {
            const photos = JSON.parse(localStorage.getItem('photos')) || [];
            
            if (index >= 0 && index < photos.length) {
                const photo = photos[index];
                const shareText = `åˆ†äº«ä¸€å¼ ç…§ç‰‡ï¼š${photo.title}`;
                
                if (navigator.share) {
                    navigator.share({
                        title: photo.title,
                        text: shareText,
                        url: window.location.href
                    }).then(() => {
                        showNotification('åˆ†äº«æˆåŠŸï¼');
                    }).catch(err => {
                        console.log('åˆ†äº«å¤±è´¥:', err);
                        copyToClipboard(shareText);
                    });
                } else {
                    copyToClipboard(shareText);
                }
            }
        }
        
        // å¤åˆ¶åˆ°å‰ªè´´æ¿
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('åˆ†äº«é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼');
            }).catch(err => {
                console.log('å¤åˆ¶å¤±è´¥:', err);
                showNotification('åˆ†äº«å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶');
            });
        }
        
        // æ‰“å¼€ç¯ç®±
        function openLightbox(index) {
            const photos = JSON.parse(localStorage.getItem('photos')) || [];
            
            if (index >= 0 && index < photos.length) {
                const photo = photos[index];
                const lightbox = document.getElementById('lightbox');
                const lightboxImg = document.getElementById('lightboxImg');
                const lightboxInfo = document.getElementById('lightboxInfo');
                
                currentLightboxIndex = index;
                lightboxImg.src = photo.dataUrl;
                lightboxImg.alt = photo.title;
                lightboxInfo.innerHTML = `
                    <h3>${photo.title}</h3>
                    <p>ä¸Šä¼ æ—¥æœŸï¼š${photo.date}</p>
                    <p>â¤ï¸ ${photo.likes || 0} æ¬¡å–œæ¬¢</p>
                `;
                
                lightbox.classList.add('active');
                document.body.style.overflow = 'hidden';
            }
        }
        
        // å…³é—­ç¯ç®±
        function closeLightbox() {
            const lightbox = document.getElementById('lightbox');
            lightbox.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // ä¸Šä¸€å¼ ç…§ç‰‡
        function prevPhoto() {
            const photos = JSON.parse(localStorage.getItem('photos')) || [];
            currentLightboxIndex = (currentLightboxIndex - 1 + photos.length) % photos.length;
            openLightbox(currentLightboxIndex);
        }
        
        // ä¸‹ä¸€å¼ ç…§ç‰‡
        function nextPhoto() {
            const photos = JSON.parse(localStorage.getItem('photos')) || [];
            currentLightboxIndex = (currentLightboxIndex + 1) % photos.length;
            openLightbox(currentLightboxIndex);
        }
        
        // é”®ç›˜æ§åˆ¶
        document.addEventListener('keydown', function(e) {
            const lightbox = document.getElementById('lightbox');
            
            if (lightbox.classList.contains('active')) {
                switch(e.key) {
                    case 'Escape':
                        closeLightbox();
                        break;
                    case 'ArrowLeft':
                        prevPhoto();
                        break;
                    case 'ArrowRight':
                        nextPhoto();
                        break;
                }
            }
        });
    </script>
</body>
</html>